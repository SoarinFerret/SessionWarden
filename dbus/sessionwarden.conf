<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">

<busconfig>

  <!--
    D-Bus policy for SessionWarden system service
    Service: io.github.soarinferret.sessionwarden
    Interface: io.github.soarinferret.sessionwarden.Manager
    Location: /etc/dbus-1/system.d/io.github.soarinferret.sessionwarden.conf
  -->

  <!-- Allow the daemon (running as root or "sessionwarden") to own and operate the service -->
  <policy user="root">
    <allow own="io.github.soarinferret.sessionwarden"/>
    <allow send_destination="io.github.soarinferret.sessionwarden"/>
    <allow receive_sender="io.github.soarinferret.sessionwarden"/>
  </policy>

  <policy user="sessionwarden">
    <allow own="io.github.soarinferret.sessionwarden"/>
    <allow send_destination="io.github.soarinferret.sessionwarden"/>
    <allow receive_sender="io.github.soarinferret.sessionwarden"/>
  </policy>

  <!--
    Allow administrative users (e.g. wheel group) to communicate with the service
    This lets you run `swctl` or similar tools as an admin.
  -->
  <policy at_console="true">
    <allow send_destination="io.github.soarinferret.sessionwarden"/>
  </policy>

  <!-- Optionally, allow all local users to receive signals from the service -->
  <policy context="default">
    <allow receive_sender="io.github.soarinferret.sessionwarden"/>
  </policy>

  <!-- Default deny for everything else -->
  <policy context="default">
    <deny own="io.github.soarinferret.sessionwarden"/>
    <deny send_destination="io.github.soarinferret.sessionwarden"/>
  </policy>

</busconfig>
